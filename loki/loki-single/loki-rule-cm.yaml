apiVersion: v1
kind: ConfigMap
metadata:
  name: loki-rules
  namespace: loki
  labels:
    app.kubernetes.io/name: loki
data:
  rules.yaml: |
    groups:
        - name: loki-alert
          rules:
            - alert: error show
              expr: sum(rate({app="loki", component="read"} |= `level=error` [1h])) by (app) * 60 > 1
              for: 1s
              labels:
                severity: info
                type: loki-alert
              annotations:
                summary: app {{$labels.app}} component {{$labels.component}} has a lot of error

     
            